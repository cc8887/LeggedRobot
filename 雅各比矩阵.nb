(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46094,       1109]
NotebookOptionsPosition[     44262,       1053]
NotebookOutlinePosition[     44619,       1069]
CellTagsIndexPosition[     44576,       1066]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyRotation", "[", 
    RowBox[{"q_", ",", "d_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"q", ",", "d"}], "]"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "l", "}"}], "]"}], ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7840869717239532`*^9, 3.7840869931160297`*^9}, {
  3.784087084613326*^9, 3.7840871849928436`*^9}, {3.7840872612516747`*^9, 
  3.784087263156598*^9}, {3.784087329934931*^9, 3.7840873414689093`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d0", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d2", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d3", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d4", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d5", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.784202563991987*^9, 3.7842026236437197`*^9}, {
  3.7842027543700547`*^9, 3.7842027630783167`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d0", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q1", ",", 
     RowBox[{"d1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q2", ",", 
     RowBox[{"d2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0.06"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q3", ",", 
     RowBox[{"d3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R4", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q4", ",", 
     RowBox[{"d4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0."}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R5", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d5", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0.19"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784087364203842*^9, 3.7840874843941956`*^9}, {
  3.7840896394000616`*^9, 3.784089641277009*^9}, {3.784153355560087*^9, 
  3.784153355679767*^9}, {3.7841554464567757`*^9, 3.7841554470030766`*^9}, {
  3.78420236490377*^9, 3.7842023752400446`*^9}, {3.784202629164584*^9, 
  3.7842026767906313`*^9}, {3.78420280548057*^9, 3.7842028169229236`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R05", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "R5"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R04", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R03", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R02", "=", 
   RowBox[{"R1", ".", "R2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R01", "=", "R1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R00", "=", "R0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta", "=", 
   RowBox[{"{", 
    RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7840876184789066`*^9, 3.784087638746236*^9}, {
  3.784087750247611*^9, 3.784087765696849*^9}, {3.784202335974147*^9, 
  3.784202349995922*^9}, {3.7842023869947834`*^9, 3.7842024247090387`*^9}, {
  3.784202487613908*^9, 3.7842024966506977`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JE", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"R15", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", "theta", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784087521721622*^9, 3.784087523119804*^9}, {
   3.7840875734944344`*^9, 3.784087610247289*^9}, {3.7840876429829063`*^9, 
   3.7840876741848855`*^9}, 3.784087755825577*^9, {3.784087791647236*^9, 
   3.7840878171720147`*^9}, {3.7840878527977486`*^9, 
   3.7840878834104786`*^9}, {3.7840879360357537`*^9, 
   3.7840879376369324`*^9}, {3.7840920774451227`*^9, 3.7840921216200294`*^9}, 
   3.7840922446690025`*^9, {3.784096403384571*^9, 3.78409641832965*^9}, {
   3.784096454148346*^9, 3.784096477088997*^9}, {3.7841568084562445`*^9, 
   3.784156824500396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JO", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", "#1", "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R00", ".", "d0"}], ",", 
        RowBox[{"R01", ".", "d1"}], ",", 
        RowBox[{"R02", ".", "d2"}], ",", 
        RowBox[{"R03", ".", "d3"}]}], "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7840903665302267`*^9, 3.784090390892088*^9}, {
   3.784090499032711*^9, 3.784090622935591*^9}, {3.7840906851373105`*^9, 
   3.7840908195475454`*^9}, 3.784090929824401*^9, 3.784091966107623*^9, {
   3.7840920192098827`*^9, 3.7840920369145355`*^9}, {3.784092096199007*^9, 
   3.7840921170123725`*^9}, 3.7840922412900486`*^9, {3.784202541749889*^9, 
   3.784202551783908*^9}, {3.784202702610325*^9, 3.784202835950523*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R00", ".", "d0"}], ",", 
       RowBox[{"R01", ".", "d1"}]}], "}"}], "]"}], "//", "MatrixForm"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.784202870358758*^9, 3.784202936575249*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"JE", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "All"}], "]"}], "]"}], ",", 
     RowBox[{"JO", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "All"}], "]"}], "]"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q1", "\[Rule]", "0"}], ",", 
     RowBox[{"q2", "\[Rule]", "0."}], ",", 
     RowBox[{"q3", "\[Rule]", "0"}], ",", 
     RowBox[{"q4", "\[Rule]", "0"}]}], "}"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7840921385038795`*^9, 3.784092150601528*^9}, {
  3.784096597046088*^9, 3.7840966321841483`*^9}, {3.784096686570486*^9, 
  3.784096724819621*^9}, {3.784096776095707*^9, 3.7840967773104305`*^9}, {
  3.78415683753578*^9, 3.784156841697178*^9}, {3.784202686036624*^9, 
  3.784202688358799*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","take",
   "\"\:65e0\:6cd5\:5728 \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\
\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\
\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"Join\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"Join\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"Join\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"Join\\\", \\\"[\\\", RowBox[{RowBox[{\\\"RotationMatrix\\\
\", \\\"[\\\", RowBox[{\\\"q1\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\
\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"0\\\", \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"q2\\\", \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", \\\"0.06`\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
\\\"2\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"Join\\\", \\\"[\\\", RowBox[{RowBox[{\\\"RotationMatrix\\\", \
\\\"[\\\", RowBox[{\\\"q3\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\
\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"0.1`\\\", \\\"}\
\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \
\\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}]}], \\\"}\\\"}], \\\"]\\\"}]\\) \:4e2d\
\:63d0\:53d6\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:81f3 \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\).\"",2,60,34,25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.784202790753441*^9}],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) \:5904\:7684\:5934\:90e8 \\!\\(\\*RowBox[{\\\"List\\\"}]\\) \
\:548c \\!\\(\\*RowBox[{\\\"Part\\\"}]\\) \
\:5e94\:8be5\:662f\:4e00\:6837\:7684.\"",2,60,35,25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.784202790788484*^9}],

Cell[BoxData[
 TemplateBox[{
  "RotationMatrix","v3d",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) \:4e0d\:662f\:4e00\
\:4e2a\:957f\:5ea6\:4e3a 3 \:7684\:5411\:91cf.\"",2,60,36,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.784202790816542*^9}],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) \:5904\:7684\:5934\:90e8 \
\\!\\(\\*RowBox[{\\\"RotationMatrix\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\"List\
\\\"}]\\) \:5e94\:8be5\:662f\:4e00\:6837\:7684.\"",2,60,37,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.784202790843479*^9}],

Cell[BoxData[
 TemplateBox[{
  "RotationMatrix","v3d",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) \:4e0d\:662f\:4e00\
\:4e2a\:957f\:5ea6\:4e3a 3 \:7684\:5411\:91cf.\"",2,60,38,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.7842027908705325`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) \:5904\:7684\:5934\:90e8 \
\\!\\(\\*RowBox[{\\\"RotationMatrix\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\"List\
\\\"}]\\) \:5e94\:8be5\:662f\:4e00\:6837\:7684.\"",2,60,39,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.784202790898426*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"\:5728\:672c\:6b21\:8ba1\:7b97\:4e2d\:ff0c\\!\\(\\*StyleBox[RowBox[{\\\"\
Join\\\", \\\"::\\\", \\\"heads\\\"}], \\\"MessageName\\\"]\\) \:7684\:8fdb\
\:4e00\:6b65\:8f93\:51fa\:5c06\:88ab\:6291\:5236.\"",2,60,40,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.7842027909254723`*^9}],

Cell[BoxData[
 TemplateBox[{
  "RotationMatrix","v3d",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) \:4e0d\:662f\:4e00\
\:4e2a\:957f\:5ea6\:4e3a 3 \:7684\:5411\:91cf.\"",2,60,41,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.7842027909534235`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"\:5728\:672c\:6b21\:8ba1\:7b97\:4e2d\:ff0c\\!\\(\\*StyleBox[RowBox[{\\\"\
RotationMatrix\\\", \\\"::\\\", \\\"v3d\\\"}], \\\"MessageName\\\"]\\) \:7684\
\:8fdb\:4e00\:6b65\:8f93\:51fa\:5c06\:88ab\:6291\:5236.\"",2,60,42,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.7842027909813504`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Transpose","nmtx",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"Join\\\", \\\"[\
\\\", RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\", \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \
\\\"2\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{RowBox[{\\\"Join\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\
\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}]}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\
\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0.`\\\", \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0.06`\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\
\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0.1`\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\
\", \\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}]}], \\\"}\\\"}]\\) \:7684\
\:524d\:4e24\:5c42\:65e0\:6cd5\:8f6c\:7f6e.\"",2,60,43,25329927098878871246,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.7842027910096216`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","take",
   "\"\:65e0\:6cd5\:5728 \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\
\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\
\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"Join\\\", \\\"[\\\", RowBox[{RowBox[{\\\"RotationMatrix\\\
\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\
\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\
\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"0\\\", \
\\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0.`\\\", \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0.06`\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"RotationMatrix\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\
\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\
\", RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"0.1`\\\", \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", \\\"2\\\", \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\"}\\\
\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\
\", \\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}]}], \\\"}\\\"}], \
\\\"]\\\"}]\\) \:4e2d\:63d0\:53d6\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \
\:81f3 \\!\\(\\*RowBox[{\\\"3\\\"}]\\).\"",2,60,44,25329927098878871246,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842026916484222`*^9, 3.784202791043357*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Integer", "[", "]"}], ",", 
      RowBox[{"Integer", "[", "]"}], ",", 
      RowBox[{"Integer", "[", "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0.`", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0.06`", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0.`", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0.06`", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0.1`", "}"}]}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
          "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "}"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "All"}], "\[RightDoubleBracket]"}]}], 
   "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7840922478485007`*^9, 3.7840966013426633`*^9, 3.78409663368112*^9, 
   3.7840967262547674`*^9, 3.784096779633248*^9, 3.784096827541184*^9, {
   3.7840981470079*^9, 3.784098160713216*^9}, 3.7841533657787867`*^9, 
   3.7841554485926533`*^9, 3.7841568431649523`*^9, 3.78420269173739*^9, 
   3.784202791090398*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.784097155161042*^9, 3.7840971592510757`*^9}, 
   3.7840972133871994`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784097229271721*^9, 3.7840972842121267`*^9}, {
  3.784097347013203*^9, 3.7840973471607895`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zero", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "zero"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "R3", ".", "zero"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "zero"}], 
           ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q2", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q3", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q4", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7840972193981524`*^9, 3.7840973243508263`*^9}, {
   3.784097355155408*^9, 3.784097384428127*^9}, 3.7840974171652875`*^9, {
   3.7840975700069385`*^9, 3.784097585655074*^9}, 3.784097840531852*^9, {
   3.784097887091755*^9, 3.7840978935046253`*^9}, {3.784098005280752*^9, 
   3.784098089970395*^9}, {3.7840981231596775`*^9, 3.78409812336512*^9}, {
   3.78409817080822*^9, 3.7840981713088827`*^9}, {3.7841534038150415`*^9, 
   3.784153455781074*^9}, 3.784155453842229*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"point", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "zero"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "R3", ".", "zero"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "zero"}], ")"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "R1", ".", "R2", ".", "R3", ".", "R4", ".", "R5", ".", "zero"}], ")"}],
       "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7841539823000536`*^9, 3.7841540032061367`*^9}, {
  3.784155397099429*^9, 3.7841554310732527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"plot1", "=", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"point", ",", 
          RowBox[{"VertexColors", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Green", ",", "Red", ",", "Green"}], 
            "}"}]}]}], "]"}], ",", "Thick", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{"Point", "[", "point", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7841540063856335`*^9, 3.784154027492222*^9}, {
   3.7841540701301684`*^9, 3.7841541540926323`*^9}, 3.7841542348616385`*^9, {
   3.784154675340932*^9, 3.784154713840293*^9}, {3.7841547787440033`*^9, 
   3.7841547918333664`*^9}, {3.784155194772979*^9, 3.7841552257869*^9}, {
   3.7841552836515555`*^9, 3.784155291884205*^9}, 3.7841553230249877`*^9, {
   3.7841553610138264`*^9, 3.7841554092219687`*^9}, {3.7841554637555075`*^9, 
   3.7841554639110937`*^9}, {3.784155630687459*^9, 3.7841556709552283`*^9}, {
   3.784156373625823*^9, 3.7841563759519196`*^9}, {3.7841564270725718`*^9, 
   3.7841564295957994`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plot1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q1", "\[Rule]", "0.1"}], ",", 
    RowBox[{"q2", "\[Rule]", "0.5"}], ",", 
    RowBox[{"q3", "\[Rule]", "0.3"}], ",", 
    RowBox[{"q4", "\[Rule]", "0.8"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.784155672814128*^9, 3.784155674594037*^9}, {
  3.784156349416297*^9, 3.784156359319212*^9}, {3.7841564393109956`*^9, 
  3.7841564720198784`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "RotationMatrix","v3d",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) \:4e0d\:662f\:4e00\
\:4e2a\:957f\:5ea6\:4e3a 3 \:7684\:5411\:91cf.\"",2,66,45,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842027912824907`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) \:5904\:7684\:5934\:90e8 \
\\!\\(\\*RowBox[{\\\"RotationMatrix\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\"List\
\\\"}]\\) \:5e94\:8be5\:662f\:4e00\:6837\:7684.\"",2,66,46,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.784202791312506*^9}],

Cell[BoxData[
 TemplateBox[{
  "RotationMatrix","v3d",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"0\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) \:4e0d\:662f\:4e00\
\:4e2a\:957f\:5ea6\:4e3a 3 \:7684\:5411\:91cf.\"",2,66,47,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842027913432894`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) \:5904\:7684\:5934\:90e8 \
\\!\\(\\*RowBox[{\\\"RotationMatrix\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\"List\
\\\"}]\\) \:5e94\:8be5\:662f\:4e00\:6837\:7684.\"",2,66,48,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842027913874397`*^9}],

Cell[BoxData[
 TemplateBox[{
  "RotationMatrix","v3d",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\
\",\\\", \\\"1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) \:4e0d\:662f\:4e00\
\:4e2a\:957f\:5ea6\:4e3a 3 \:7684\:5411\:91cf.\"",2,66,49,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.784202791430544*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"\:5728\:672c\:6b21\:8ba1\:7b97\:4e2d\:ff0c\\!\\(\\*StyleBox[RowBox[{\\\"\
RotationMatrix\\\", \\\"::\\\", \\\"v3d\\\"}], \\\"MessageName\\\"]\\) \:7684\
\:8fdb\:4e00\:6b65\:8f93\:51fa\:5c06\:88ab\:6291\:5236.\"",2,66,50,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.784202791470567*^9}],

Cell[BoxData[
 TemplateBox[{
  "Join","heads",
   "\"\:4f4d\:7f6e \\!\\(\\*RowBox[{\\\"1\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) \:5904\:7684\:5934\:90e8 \
\\!\\(\\*RowBox[{\\\"RotationMatrix\\\"}]\\) \:548c \\!\\(\\*RowBox[{\\\"List\
\\\"}]\\) \:5e94\:8be5\:662f\:4e00\:6837\:7684.\"",2,66,51,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842027915133886`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"\:5728\:672c\:6b21\:8ba1\:7b97\:4e2d\:ff0c\\!\\(\\*StyleBox[RowBox[{\\\"\
Join\\\", \\\"::\\\", \\\"heads\\\"}], \\\"MessageName\\\"]\\) \:7684\:8fdb\
\:4e00\:6b65\:8f93\:51fa\:5c06\:88ab\:6291\:5236.\"",2,66,52,
   25329927098878871246,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.784202791554481*^9}],

Cell[BoxData[
 Graphics3DBox[{
   Line3DBox[{{0, 0, 0}, Dot[
     Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
       1}}], {0, 0, 0, 1}], Dot[
     Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.3, {0, 1, 0, 1}], {{0}, {0}, {0.1}}, 2, {{0, 0, 0, 
       1}}]], Dot[
     Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.3, {0, 1, 0, 1}], {{0}, {0}, {0.1}}, 2, {{0, 0, 0, 
       1}}]], Dot[
     Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
       1}}], Join[
      RotationMatrix[0.3, {0, 1, 0, 1}], {{0}, {0}, {0.1}}, 2, {{0, 0, 0, 
       1}}]]},
    VertexColors->{
      RGBColor[1, 0, 0], 
      RGBColor[0, 1, 0], 
      RGBColor[1, 0, 0], 
      RGBColor[0, 1, 0]}], 
   {Thickness[Large], 
    {PointSize[Large], 
     Point3DBox[{{0, 0, 0}, Dot[
       Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
         1}}], {0, 0, 0, 1}], Dot[
       Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.3, {0, 1, 0, 1}], {{0}, {0}, {0.1}}, 2, {{0, 0, 0, 
         1}}]], Dot[
       Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.3, {0, 1, 0, 1}], {{0}, {0}, {0.1}}, 2, {{0, 0, 0, 
         1}}]], Dot[
       Join[RotationMatrix[0.1, {0, 0, 1, 1}], {{0}, {0}, {0}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.5, {1, 0, 0, 1}], {{0}, {0}, {0.06}}, 2, {{0, 0, 0, 
         1}}], Join[
        RotationMatrix[0.3, {0, 1, 0, 1}], {{0}, {0}, {0.1}}, 2, {{0, 0, 0, 
         1}}]]}]}}},
  ImageSize->{384.1520408193077, 373.54279657435285`},
  PlotRange->1,
  ViewPoint->{3.1909650888427272`, -0.3349205162373241, 1.0749744413660556`},
  ViewVertical->{0.30012232873483635`, -0.05568451450347528, 
   0.9522740270737678}]], "Output",
 CellChangeTimes->{
  3.7841541556045947`*^9, 3.784154235423137*^9, {3.7841546773555317`*^9, 
   3.784154723427019*^9}, {3.7841547926796947`*^9, 3.7841547984729805`*^9}, {
   3.78415521105669*^9, 3.7841552261166124`*^9}, {3.7841552846850915`*^9, 
   3.7841552924813147`*^9}, 3.7841553329379873`*^9, {3.7841553637877684`*^9, 
   3.784155464668498*^9}, 3.784155633529126*^9, 3.7841556794147577`*^9, 
   3.7841563600286446`*^9, {3.784156423447282*^9, 3.784156472504996*^9}, 
   3.784202692847534*^9, 3.7842027915873036`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q1", "=", "0"}], ",", 
     RowBox[{"q2", "=", "0"}], ",", 
     RowBox[{"q3", "=", "0"}], ",", 
     RowBox[{"q4", "=", "0"}]}], "}"}], ",", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
           RowBox[{"Slider", "[", 
            RowBox[{"Dynamic", "[", "q1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Green", ",", 
               RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
           RowBox[{"Slider", "[", 
            RowBox[{"Dynamic", "[", "q2", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Green", ",", 
               RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
           RowBox[{"Slider", "[", 
            RowBox[{"Dynamic", "[", "q4", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
           RowBox[{"Slider", "[", 
            RowBox[{"Dynamic", "[", "q3", "]"}], "]"}]}], "}"}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", "plot1", "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.784155765004445*^9, 3.7841558853984985`*^9}, {
  3.784155963593718*^9, 3.784155977408965*^9}}],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`q1$$ = 0, $CellContext`q2$$ = 
  0, $CellContext`q3$$ = 0, $CellContext`q4$$ = 0}, 
  TagBox[GridBox[{
     {
      TagBox[GridBox[{
         {
          GraphicsBox[
           {RGBColor[1, 0, 0], RectangleBox[{0, 0}]},
           ImageSize->30], 
          SliderBox[Dynamic[$CellContext`q1$$]]},
         {
          GraphicsBox[
           {RGBColor[0, 1, 0], RectangleBox[{0, 0}]},
           ImageSize->30], 
          SliderBox[Dynamic[$CellContext`q2$$]]},
         {
          GraphicsBox[
           {RGBColor[0, 1, 0], RectangleBox[{0, 0}]},
           ImageSize->30], 
          SliderBox[Dynamic[$CellContext`q4$$]]},
         {
          GraphicsBox[
           {RGBColor[0, 0, 1], RectangleBox[{0, 0}]},
           ImageSize->30], 
          SliderBox[Dynamic[$CellContext`q3$$]]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]},
     {
      DynamicBox[ToBoxes[$CellContext`plot1, StandardForm],
       ImageSizeCache->{180., {95., 100.}}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{3.7841559783955407`*^9, 3.7842026929774647`*^9, 
  3.784202791663299*^9}]
}, Open  ]]
},
WindowSize->{750, 679},
WindowMargins->{{Automatic, 271}, {-2, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (2016\:5e7410\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 741, 19, 68, "Input"],
Cell[1302, 41, 1069, 34, 145, "Input"],
Cell[2374, 77, 2153, 64, 126, "Input"],
Cell[4530, 143, 1011, 26, 145, "Input"],
Cell[5544, 171, 834, 17, 47, "Input"],
Cell[6381, 190, 867, 19, 47, "Input"],
Cell[7251, 211, 332, 10, 66, "Input"],
Cell[CellGroupData[{
Cell[7608, 225, 893, 23, 84, "Input"],
Cell[8504, 250, 4036, 57, 105, "Message"],
Cell[12543, 309, 431, 8, 24, "Message"],
Cell[12977, 319, 412, 8, 24, "Message"],
Cell[13392, 329, 445, 9, 24, "Message"],
Cell[13840, 340, 414, 8, 24, "Message"],
Cell[14257, 350, 445, 9, 24, "Message"],
Cell[14705, 361, 410, 8, 24, "Message"],
Cell[15118, 371, 414, 8, 24, "Message"],
Cell[15535, 381, 418, 8, 24, "Message"],
Cell[15956, 391, 4079, 57, 105, "Message"],
Cell[20038, 450, 3481, 49, 105, "Message"],
Cell[23522, 501, 5394, 148, 197, "Output"]
}, Open  ]],
Cell[28931, 652, 122, 2, 30, "Input"],
Cell[29056, 656, 258, 6, 30, "Input"],
Cell[29317, 664, 1888, 47, 142, "Input"],
Cell[31208, 713, 1077, 32, 50, "Input"],
Cell[32288, 747, 1298, 28, 105, "Input"],
Cell[CellGroupData[{
Cell[33611, 779, 425, 10, 30, "Input"],
Cell[34039, 791, 390, 8, 24, "Message"],
Cell[34432, 801, 421, 9, 24, "Message"],
Cell[34856, 812, 390, 8, 24, "Message"],
Cell[35249, 822, 423, 9, 24, "Message"],
Cell[35675, 833, 388, 8, 24, "Message"],
Cell[36066, 843, 392, 8, 24, "Message"],
Cell[36461, 853, 423, 9, 24, "Message"],
Cell[36887, 864, 384, 8, 24, "Message"],
Cell[37274, 874, 3195, 67, 389, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40506, 946, 2329, 61, 253, "Input"],
Cell[42838, 1009, 1408, 41, 353, "Output"]
}, Open  ]]
}
]
*)

