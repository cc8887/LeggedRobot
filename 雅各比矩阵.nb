(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30000,        881]
NotebookOptionsPosition[     28404,        825]
NotebookOutlinePosition[     28792,        842]
CellTagsIndexPosition[     28749,        839]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyRotation", "[", 
    RowBox[{"q_", ",", "d_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"q", ",", "d"}], "]"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "l", "}"}], "]"}], ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7840869717239532`*^9, 3.7840869931160297`*^9}, {
  3.784087084613326*^9, 3.7840871849928436`*^9}, {3.7840872612516747`*^9, 
  3.784087263156598*^9}, {3.784087329934931*^9, 3.7840873414689093`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d0", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d2", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d3", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d4", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d5", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.784202563991987*^9, 3.7842026236437197`*^9}, {
  3.7842027543700547`*^9, 3.7842027630783167`*^9}, {3.784238120888293*^9, 
  3.784238122312552*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l0", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.06"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l3", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l4", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l5", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.19"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784229095346897*^9, 3.7842291853023853`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d0", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q1", ",", 
     RowBox[{"d1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q2", ",", 
     RowBox[{"d2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q3", ",", 
     RowBox[{"d3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R4", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q4", ",", 
     RowBox[{"d4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R5", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d5", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l5"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.784087364203842*^9, 3.7840874843941956`*^9}, {
  3.7840896394000616`*^9, 3.784089641277009*^9}, {3.784153355560087*^9, 
  3.784153355679767*^9}, {3.7841554464567757`*^9, 3.7841554470030766`*^9}, {
  3.78420236490377*^9, 3.7842023752400446`*^9}, {3.784202629164584*^9, 
  3.7842026767906313`*^9}, {3.78420280548057*^9, 3.7842028169229236`*^9}, {
  3.784229243959544*^9, 3.7842292816537213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R05", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "R5"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R04", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R03", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R02", "=", 
   RowBox[{"R1", ".", "R2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R01", "=", "R1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R00", "=", "R0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta", "=", 
   RowBox[{"{", 
    RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7840876184789066`*^9, 3.784087638746236*^9}, {
   3.784087750247611*^9, 3.784087765696849*^9}, {3.784202335974147*^9, 
   3.784202349995922*^9}, {3.7842023869947834`*^9, 3.7842024247090387`*^9}, {
   3.784202487613908*^9, 3.7842024966506977`*^9}, {3.784230054243786*^9, 
   3.7842301068540797`*^9}, 3.7842385529909496`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l05", "=", 
   RowBox[{"R05", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l04", "=", 
   RowBox[{"R04", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l03", "=", 
   RowBox[{"R03", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l02", "=", 
   RowBox[{"R02", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l01", "=", 
   RowBox[{"R01", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l00", "=", 
   RowBox[{"R00", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784230120558461*^9, 3.7842301980891485`*^9}}],

Cell[TextData[{
 "\n\:96c5\:5404\:6bd4\:77e9\:9635\:ff1aJOE=",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"JE"},
      {"JO"}
     }], "\[NoBreak]", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.7842384061661*^9, 3.7842385422303667`*^9}},
 FormatType->"TextForm"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JE", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", "#1", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "#2"}], "]"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R00", ".", "d1"}], ",", 
            RowBox[{"R01", ".", "d2"}], ",", 
            RowBox[{"R02", ".", "d3"}], ",", 
            RowBox[{"R03", ".", "d4"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"l04", "-", "l00"}], ",", 
            RowBox[{"l04", "-", "l01"}], ",", 
            RowBox[{"l04", "-", "l02"}], ",", 
            RowBox[{"l04", "-", "l03"}]}], "}"}]}], "}"}]}], "]"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JO", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", "#1", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", 
              RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
           RowBox[{"#2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"R00", ",", "R01", ",", "R02", ",", "R03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d1", ",", "d2", ",", "d3", ",", "d4"}], "}"}]}], "}"}]}], 
       "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JOE", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"JE", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "All"}], "]"}], "]"}], ",", 
     RowBox[{"JO", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "All"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.784087521721622*^9, 3.784087523119804*^9}, {
   3.7840875734944344`*^9, 3.784087610247289*^9}, {3.7840876429829063`*^9, 
   3.7840876741848855`*^9}, 3.784087755825577*^9, {3.784087791647236*^9, 
   3.7840878171720147`*^9}, {3.7840878527977486`*^9, 
   3.7840878834104786`*^9}, {3.7840879360357537`*^9, 
   3.7840879376369324`*^9}, {3.7840920774451227`*^9, 3.7840921216200294`*^9}, 
   3.7840922446690025`*^9, {3.784096403384571*^9, 3.78409641832965*^9}, {
   3.784096454148346*^9, 3.784096477088997*^9}, {3.7841568084562445`*^9, 
   3.784156824500396*^9}, {3.7842273047691956`*^9, 3.7842273050515456`*^9}, {
   3.784230205633979*^9, 3.7842302145411615`*^9}, {3.7842302528497205`*^9, 
   3.784230278561968*^9}, {3.7842358293825755`*^9, 3.78423586707141*^9}, {
   3.784236025447584*^9, 3.784236048485411*^9}, {3.7842364342286096`*^9, 
   3.784236454864538*^9}, {3.7842365258784184`*^9, 3.784236574639675*^9}, {
   3.7842366244283133`*^9, 3.784236640391249*^9}, {3.784236796206482*^9, 
   3.784236811195011*^9}, {3.7842382142414346`*^9, 3.784238221818529*^9}}],

Cell[TextData[{
 "\:672b\:7aef\:70b9\:901f\:5ea6\:53ca\:89d2\:901f\:5ea6\:ff1avel",
 Cell[BoxData[
  RowBox[{"=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"v"},
      {"\[Omega]"}
     }], "\[NoBreak]", ")"}]}]]],
 "=JOE\[CenterDot]q"
}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.7842384061661*^9, 3.7842384425069675`*^9}, {
  3.7842385659805555`*^9, 3.784238627895355*^9}, {3.784238736571594*^9, 
  3.784238742233879*^9}},
 FormatType->"TextForm"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vel", "=", 
  RowBox[{
   RowBox[{"JOE", ".", "theta"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.784097155161042*^9, 3.7840971592510757`*^9}, 
   3.7840972133871994`*^9, {3.7842382305531573`*^9, 3.7842382460574317`*^9}, {
   3.7842383003904552`*^9, 3.784238304527128*^9}, {3.7842387009043856`*^9, 
   3.784238740234829*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.06`", " ", 
            RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
           RowBox[{"0.1`", " ", 
            RowBox[{"Cos", "[", "q1", "]"}], " ", 
            RowBox[{"Cos", "[", "q2", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"q1", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "-", 
           RowBox[{"0.1`", " ", 
            RowBox[{"Sin", "[", "q1", "]"}], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"q3", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.1`", " ", 
            RowBox[{"Cos", "[", "q1", "]"}], " ", 
            RowBox[{"Cos", "[", "q2", "]"}]}], "-", 
           RowBox[{"0.006`", " ", 
            RowBox[{"Sin", "[", "q1", "]"}], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.06`", " ", 
            RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
           RowBox[{"0.1`", " ", 
            RowBox[{"Cos", "[", "q2", "]"}], " ", 
            RowBox[{"Sin", "[", "q1", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"q3", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.1`", " ", 
            RowBox[{"Cos", "[", "q2", "]"}], " ", 
            RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
           RowBox[{"0.006`", " ", 
            RowBox[{"Cos", "[", "q1", "]"}], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"q1", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"0.1`", " ", 
            RowBox[{"Cos", "[", "q1", "]"}], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "-", 
           RowBox[{"0.1`", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "q1", "]"}], "2"], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}], "-", 
           RowBox[{"0.1`", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "q1", "]"}], "2"], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"q3", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "-", 
           RowBox[{"0.1`", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "q1", "]"}], "2"], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}], "-", 
           RowBox[{"0.1`", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "q1", "]"}], "2"], " ", 
            RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"q4", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "-", 
           RowBox[{"Sin", "[", "q1", "]"}]}], ")"}]}], "-", 
        RowBox[{"q2", " ", 
         RowBox[{"Sin", "[", "q1", "]"}]}], "-", 
        RowBox[{"q3", " ", 
         RowBox[{"Sin", "[", "q1", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"q2", " ", 
         RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
        RowBox[{"q3", " ", 
         RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
        RowBox[{"q4", " ", 
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"Cos", "[", "q1", "]"}]}], ")"}]}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", "q1"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7842382392569904`*^9, 3.7842382465850344`*^9}, 
   3.7842383094525037`*^9, 3.7842387644923687`*^9}]
}, Open  ]],

Cell["\:82e5\:4e8c\:4e09\:5173\:8282\:9759\:6b62\:ff0c\:901f\:5ea6\:8868\:8fbe\
\:5f0f\:4e3a\:ff1a\[Omega]=JOE\[CenterDot]q", "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.7842384061661*^9, 3.7842384425069675`*^9}, {
  3.7842385659805555`*^9, 3.784238627895355*^9}, {3.7842386611442986`*^9, 
  3.784238683019411*^9}},
 FormatType->"TextForm"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vel", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q2", "\[Rule]", "0"}], ",", 
    RowBox[{"q3", "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7842383122014737`*^9, 3.7842383633528566`*^9}, {
  3.78423864008025*^9, 3.784238654704832*^9}, {3.784238732118329*^9, 
  3.784238732880556*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {
       RowBox[{"q4", " ", 
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "-", 
          RowBox[{"Sin", "[", "q1", "]"}]}], ")"}]}]},
      {
       RowBox[{"q4", " ", 
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"Cos", "[", "q1", "]"}]}], ")"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", "q1"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7842383548984385`*^9, 3.784238363672243*^9}, 
   3.784238766567235*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784097229271721*^9, 3.7840972842121267`*^9}, {
  3.784097347013203*^9, 3.7840973471607895`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zero", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "zero"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "R3", ".", "zero"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "zero"}], 
           ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q2", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q3", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q4", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7840972193981524`*^9, 3.7840973243508263`*^9}, {
   3.784097355155408*^9, 3.784097384428127*^9}, 3.7840974171652875`*^9, {
   3.7840975700069385`*^9, 3.784097585655074*^9}, 3.784097840531852*^9, {
   3.784097887091755*^9, 3.7840978935046253`*^9}, {3.784098005280752*^9, 
   3.784098089970395*^9}, {3.7840981231596775`*^9, 3.78409812336512*^9}, {
   3.78409817080822*^9, 3.7840981713088827`*^9}, {3.7841534038150415`*^9, 
   3.784153455781074*^9}, 3.784155453842229*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"point", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "zero"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "R3", ".", "zero"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "zero"}], ")"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "R1", ".", "R2", ".", "R3", ".", "R4", ".", "R5", ".", "zero"}], ")"}],
       "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7841539823000536`*^9, 3.7841540032061367`*^9}, {
  3.784155397099429*^9, 3.7841554310732527`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plot1", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"point", ",", 
         RowBox[{"VertexColors", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Green", ",", "Red", ",", "Green"}], "}"}]}]}],
         "]"}], ",", "Thick", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "Large", "]"}], ",", 
         RowBox[{"Point", "[", "point", "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "0.4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q1", "\[Rule]", "0."}], ",", 
    RowBox[{"q2", "\[Rule]", "0."}], ",", 
    RowBox[{"q3", "\[Rule]", "0."}], ",", 
    RowBox[{"q4", "\[Rule]", "0."}]}], 
   "}"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7841540063856335`*^9, 3.784154027492222*^9}, {
   3.7841540701301684`*^9, 3.7841541540926323`*^9}, 3.7841542348616385`*^9, {
   3.784154675340932*^9, 3.784154713840293*^9}, {3.7841547787440033`*^9, 
   3.7841547918333664`*^9}, {3.784155194772979*^9, 3.7841552257869*^9}, {
   3.7841552836515555`*^9, 3.784155291884205*^9}, 3.7841553230249877`*^9, {
   3.7841553610138264`*^9, 3.7841554092219687`*^9}, {3.7841554637555075`*^9, 
   3.7841554639110937`*^9}, {3.784155630687459*^9, 3.7841556709552283`*^9}, {
   3.784156373625823*^9, 3.7841563759519196`*^9}, {3.7841564270725718`*^9, 
   3.7841564295957994`*^9}, {3.7842380618159447`*^9, 3.7842380980770044`*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   Line3DBox[{{0, 0, 0}, {0., 0., 0.06}, {0., 0., 0.16}, {0., 0., 0.16}, {0., 
     0., 0.35}},
    VertexColors->{
      RGBColor[1, 0, 0], 
      RGBColor[0, 1, 0], 
      RGBColor[1, 0, 0], 
      RGBColor[0, 1, 0]}], 
   {Thickness[Large], 
    {PointSize[Large], 
     Point3DBox[{{0, 0, 0}, {0., 0., 0.06}, {0., 0., 0.16}, {0., 0., 0.16}, {
       0., 0., 0.35}}]}}},
  ImageSize->{330.39432340222027`, 329.05866948947687`},
  PlotRange->0.4,
  ViewPoint->{2.9340758505031146`, -0.5123388613740418, 1.6058355440767826`},
  ViewVertical->{0.14643673774844645`, 0.03368818914710385, 
   0.9886462399410528}]], "Output",
 CellChangeTimes->{{3.784238081299383*^9, 3.784238126647483*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q1", "=", "0"}], ",", 
      RowBox[{"q2", "=", "0"}], ",", 
      RowBox[{"q3", "=", "0"}], ",", 
      RowBox[{"q4", "=", "0"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Green", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q2", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Green", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q4", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q3", "]"}], "]"}]}], "}"}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "[", "plot1", "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784155765004445*^9, 3.7841558853984985`*^9}, {
  3.784155963593718*^9, 3.784155977408965*^9}, {3.7842357743651724`*^9, 
  3.7842357877347546`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cross", "[", 
  RowBox[{
   RowBox[{"R00", ".", "d1"}], ",", "l04"}], "]"}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "Cross","nonn1",
   "\"\:53d8\:91cf\:5fc5\:987b\:662f\:5177\:6709\:76f8\:7b49\:957f\:5ea6\:7684\
\:5411\:91cf\:ff0c\:53d8\:91cf\:6570\:76ee\:5fc5\:987b\:6bd4\:5b83\:4eec\:7684\
\:957f\:5ea6\:5c11 1.\"",2,216,34,25330088158049611827,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842367117319775`*^9, 3.784238126706008*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1`", " ", 
      RowBox[{"Cos", "[", "q1", "]"}], " ", 
      RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1`", " ", 
      RowBox[{"Sin", "[", "q1", "]"}], " ", 
      RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
    RowBox[{"0.06`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1`", " ", 
      RowBox[{"Cos", "[", "q2", "]"}]}]}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.7842367117359943`*^9, 3.784238126738735*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R00", ".", "d1"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.784236718823616*^9, 3.7842381267677946`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["l04"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"Cos", "[", "q1", "]"}], " ", 
     RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"Sin", "[", "q1", "]"}], " ", 
     RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
   RowBox[{"0.06`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"Cos", "[", "q2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7842367226361403`*^9, 3.7842381267999067`*^9}]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (2016\:5e7410\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 741, 19, 57, "Input"],
Cell[1302, 41, 1118, 35, 182, "Input"],
Cell[2423, 78, 852, 27, 158, "Input"],
Cell[3278, 107, 1826, 54, 158, "Input"],
Cell[5107, 163, 1090, 27, 182, "Input"],
Cell[6200, 192, 1164, 42, 158, "Input"],
Cell[7367, 236, 362, 12, 76, "Input",
 Evaluatable->False],
Cell[7732, 250, 3462, 87, 261, "Input"],
Cell[11197, 339, 466, 14, 53, "Input",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[11688, 357, 364, 7, 57, "Input"],
Cell[12055, 366, 4364, 115, 163, "Output"]
}, Open  ]],
Cell[16434, 484, 348, 6, 37, "Input",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[16807, 494, 330, 8, 37, "Input"],
Cell[17140, 504, 1128, 34, 156, "Output"]
}, Open  ]],
Cell[18283, 541, 258, 6, 37, "Input"],
Cell[18544, 549, 1888, 47, 83, "Input"],
Cell[20435, 598, 1077, 32, 37, "Input"],
Cell[CellGroupData[{
Cell[21537, 634, 1578, 35, 107, "Input"],
Cell[23118, 671, 720, 18, 461, "Output"]
}, Open  ]],
Cell[23853, 692, 2458, 63, 263, "Input"],
Cell[CellGroupData[{
Cell[26336, 759, 110, 3, 57, "Input"],
Cell[26449, 764, 379, 7, 30, "Message"],
Cell[26831, 773, 672, 17, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27540, 795, 52, 1, 37, "Input"],
Cell[27595, 798, 159, 3, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27791, 806, 29, 0, 37, "Input"],
Cell[27823, 808, 565, 14, 37, "Output"]
}, Open  ]]
}
]
*)

