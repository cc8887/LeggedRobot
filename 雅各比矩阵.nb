(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25893,        743]
NotebookOptionsPosition[     24502,        695]
NotebookOutlinePosition[     24859,        711]
CellTagsIndexPosition[     24816,        708]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyRotation", "[", 
    RowBox[{"q_", ",", "d_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"RotationMatrix", "[", 
        RowBox[{"q", ",", "d"}], "]"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "l", "}"}], "]"}], ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7840869717239532`*^9, 3.7840869931160297`*^9}, {
  3.784087084613326*^9, 3.7840871849928436`*^9}, {3.7840872612516747`*^9, 
  3.784087263156598*^9}, {3.784087329934931*^9, 3.7840873414689093`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d0", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d2", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d3", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d4", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d5", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.784202563991987*^9, 3.7842026236437197`*^9}, {
  3.7842027543700547`*^9, 3.7842027630783167`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l0", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l2", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.06"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l3", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l4", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l5", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.19"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784229095346897*^9, 3.7842291853023853`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d0", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q1", ",", 
     RowBox[{"d1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q2", ",", 
     RowBox[{"d2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q3", ",", 
     RowBox[{"d3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R4", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"q4", ",", 
     RowBox[{"d4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R5", "=", 
   RowBox[{"MyRotation", "[", 
    RowBox[{"0", ",", 
     RowBox[{"d5", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "l5"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.784087364203842*^9, 3.7840874843941956`*^9}, {
  3.7840896394000616`*^9, 3.784089641277009*^9}, {3.784153355560087*^9, 
  3.784153355679767*^9}, {3.7841554464567757`*^9, 3.7841554470030766`*^9}, {
  3.78420236490377*^9, 3.7842023752400446`*^9}, {3.784202629164584*^9, 
  3.7842026767906313`*^9}, {3.78420280548057*^9, 3.7842028169229236`*^9}, {
  3.784229243959544*^9, 3.7842292816537213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R05", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "R5"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R04", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R03", "=", 
   RowBox[{"R1", ".", "R2", ".", "R3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R02", "=", 
   RowBox[{"R1", ".", "R2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R01", "=", "R1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R00", "=", "R0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta", "=", 
   RowBox[{"{", 
    RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7840876184789066`*^9, 3.784087638746236*^9}, {
  3.784087750247611*^9, 3.784087765696849*^9}, {3.784202335974147*^9, 
  3.784202349995922*^9}, {3.7842023869947834`*^9, 3.7842024247090387`*^9}, {
  3.784202487613908*^9, 3.7842024966506977`*^9}, {3.784230054243786*^9, 
  3.7842301068540797`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l05", "=", 
   RowBox[{"R05", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l04", "=", 
   RowBox[{"R04", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l03", "=", 
   RowBox[{"R03", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l02", "=", 
   RowBox[{"R02", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l01", "=", 
   RowBox[{"R01", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l00", "=", 
   RowBox[{"R00", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784230120558461*^9, 3.7842301980891485`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JE", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"R05", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", "theta", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JE", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", "#1", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "#2"}], "]"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R00", ".", "d1"}], ",", 
            RowBox[{"R01", ".", "d2"}], ",", 
            RowBox[{"R02", ".", "d3"}], ",", 
            RowBox[{"R03", ".", "d4"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"l04", "-", "l00"}], ",", 
            RowBox[{"l04", "-", "l01"}], ",", 
            RowBox[{"l04", "-", "l02"}], ",", 
            RowBox[{"l04", "-", "l03"}]}], "}"}]}], "}"}]}], "]"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.784087521721622*^9, 3.784087523119804*^9}, {
   3.7840875734944344`*^9, 3.784087610247289*^9}, {3.7840876429829063`*^9, 
   3.7840876741848855`*^9}, 3.784087755825577*^9, {3.784087791647236*^9, 
   3.7840878171720147`*^9}, {3.7840878527977486`*^9, 
   3.7840878834104786`*^9}, {3.7840879360357537`*^9, 
   3.7840879376369324`*^9}, {3.7840920774451227`*^9, 3.7840921216200294`*^9}, 
   3.7840922446690025`*^9, {3.784096403384571*^9, 3.78409641832965*^9}, {
   3.784096454148346*^9, 3.784096477088997*^9}, {3.7841568084562445`*^9, 
   3.784156824500396*^9}, {3.7842273047691956`*^9, 3.7842273050515456`*^9}, {
   3.784230205633979*^9, 3.7842302145411615`*^9}, {3.7842302528497205`*^9, 
   3.784230278561968*^9}, {3.7842358293825755`*^9, 3.78423586707141*^9}, {
   3.784236025447584*^9, 3.784236048485411*^9}, {3.7842364342286096`*^9, 
   3.784236454864538*^9}, {3.7842365258784184`*^9, 3.784236574639675*^9}, {
   3.7842366244283133`*^9, 3.784236640391249*^9}, {3.784236796206482*^9, 
   3.784236811195011*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JO", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", "#1", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", 
              RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
           RowBox[{"#2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"R00", ",", "R01", ",", "R02", ",", "R03"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"d1", ",", "d2", ",", "d3", ",", "d4"}], "}"}]}], "}"}]}], 
       "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7840903665302267`*^9, 3.784090390892088*^9}, {
   3.784090499032711*^9, 3.784090622935591*^9}, {3.7840906851373105`*^9, 
   3.7840908195475454`*^9}, 3.784090929824401*^9, 3.784091966107623*^9, {
   3.7840920192098827`*^9, 3.7840920369145355`*^9}, {3.784092096199007*^9, 
   3.7840921170123725`*^9}, 3.7840922412900486`*^9, {3.784202541749889*^9, 
   3.784202551783908*^9}, {3.784202702610325*^9, 3.784202835950523*^9}, {
   3.7842290287250643`*^9, 3.7842290366508465`*^9}, {3.784237512234651*^9, 
   3.7842376215108633`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"JE", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "All"}], "]"}], "]"}], ",", 
     RowBox[{"JO", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", "All"}], "]"}], "]"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q1", "\[Rule]", "0"}], ",", 
     RowBox[{"q2", "\[Rule]", "0."}], ",", 
     RowBox[{"q3", "\[Rule]", "0"}], ",", 
     RowBox[{"q4", "\[Rule]", "0"}]}], "}"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7840921385038795`*^9, 3.784092150601528*^9}, {
  3.784096597046088*^9, 3.7840966321841483`*^9}, {3.784096686570486*^9, 
  3.784096724819621*^9}, {3.784096776095707*^9, 3.7840967773104305`*^9}, {
  3.78415683753578*^9, 3.784156841697178*^9}, {3.784202686036624*^9, 
  3.784202688358799*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.1`", "0"},
     {"0.`", 
      RowBox[{"-", "0.16`"}], "0.`", "0"},
     {"0.`", "0.`", "0.`", "0"},
     {"0", "1", "0.`", "0.`"},
     {"0", "0", "1.`", "1.`"},
     {"1", "0", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7840922478485007`*^9, 3.7840966013426633`*^9, 3.78409663368112*^9, 
   3.7840967262547674`*^9, 3.784096779633248*^9, 3.784096827541184*^9, {
   3.7840981470079*^9, 3.784098160713216*^9}, 3.7841533657787867`*^9, 
   3.7841554485926533`*^9, 3.7841568431649523`*^9, 3.78420269173739*^9, 
   3.784202791090398*^9, 3.784227264354264*^9, 3.7842273068630924`*^9, 
   3.7842365413604097`*^9, 3.7842368305214777`*^9, 3.784237657583295*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.784097155161042*^9, 3.7840971592510757`*^9}, 
   3.7840972133871994`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784097229271721*^9, 3.7840972842121267`*^9}, {
  3.784097347013203*^9, 3.7840973471607895`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zero", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "zero"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "R3", ".", "zero"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "zero"}], 
           ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q2", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q3", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q4", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7840972193981524`*^9, 3.7840973243508263`*^9}, {
   3.784097355155408*^9, 3.784097384428127*^9}, 3.7840974171652875`*^9, {
   3.7840975700069385`*^9, 3.784097585655074*^9}, 3.784097840531852*^9, {
   3.784097887091755*^9, 3.7840978935046253`*^9}, {3.784098005280752*^9, 
   3.784098089970395*^9}, {3.7840981231596775`*^9, 3.78409812336512*^9}, {
   3.78409817080822*^9, 3.7840981713088827`*^9}, {3.7841534038150415`*^9, 
   3.784153455781074*^9}, 3.784155453842229*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"point", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zero", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "zero"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "R3", ".", "zero"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"R1", ".", "R2", ".", "R3", ".", "R4", ".", "zero"}], ")"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "R1", ".", "R2", ".", "R3", ".", "R4", ".", "R5", ".", "zero"}], ")"}],
       "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7841539823000536`*^9, 3.7841540032061367`*^9}, {
  3.784155397099429*^9, 3.7841554310732527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"plot1", "=", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"point", ",", 
          RowBox[{"VertexColors", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Green", ",", "Red", ",", "Green"}], 
            "}"}]}]}], "]"}], ",", "Thick", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{"Point", "[", "point", "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7841540063856335`*^9, 3.784154027492222*^9}, {
   3.7841540701301684`*^9, 3.7841541540926323`*^9}, 3.7841542348616385`*^9, {
   3.784154675340932*^9, 3.784154713840293*^9}, {3.7841547787440033`*^9, 
   3.7841547918333664`*^9}, {3.784155194772979*^9, 3.7841552257869*^9}, {
   3.7841552836515555`*^9, 3.784155291884205*^9}, 3.7841553230249877`*^9, {
   3.7841553610138264`*^9, 3.7841554092219687`*^9}, {3.7841554637555075`*^9, 
   3.7841554639110937`*^9}, {3.784155630687459*^9, 3.7841556709552283`*^9}, {
   3.784156373625823*^9, 3.7841563759519196`*^9}, {3.7841564270725718`*^9, 
   3.7841564295957994`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plot1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q1", "\[Rule]", "0.1"}], ",", 
    RowBox[{"q2", "\[Rule]", "0.5"}], ",", 
    RowBox[{"q3", "\[Rule]", "0.3"}], ",", 
    RowBox[{"q4", "\[Rule]", "0.8"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.784155672814128*^9, 3.784155674594037*^9}, {
  3.784156349416297*^9, 3.784156359319212*^9}, {3.7841564393109956`*^9, 
  3.7841564720198784`*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   Line3DBox[{{0, 0, 0}, {0., 0., 0.06}, {
     0.004786268954660339, -0.0477030407851843, 0.14775825618903726`}, {
     0.004786268954660339, -0.0477030407851843, 0.14775825618903726`}, {
     0.17739468844277081`, -0.0719103455356899, 0.22339118498683427`}},
    VertexColors->{
      RGBColor[1, 0, 0], 
      RGBColor[0, 1, 0], 
      RGBColor[1, 0, 0], 
      RGBColor[0, 1, 0]}], 
   {Thickness[Large], 
    {PointSize[Large], 
     Point3DBox[{{0, 0, 0}, {0., 0., 0.06}, {
       0.004786268954660339, -0.0477030407851843, 0.14775825618903726`}, {
       0.004786268954660339, -0.0477030407851843, 0.14775825618903726`}, {
       0.17739468844277081`, -0.0719103455356899, 0.22339118498683427`}}]}}},
  ImageSize->{384.1520408193077, 373.54279657435285`},
  PlotRange->1,
  ViewPoint->{3.1909650888427272`, -0.3349205162373241, 1.0749744413660556`},
  ViewVertical->{0.30012232873483635`, -0.05568451450347528, 
   0.9522740270737678}]], "Output",
 CellChangeTimes->{
  3.7841541556045947`*^9, 3.784154235423137*^9, {3.7841546773555317`*^9, 
   3.784154723427019*^9}, {3.7841547926796947`*^9, 3.7841547984729805`*^9}, {
   3.78415521105669*^9, 3.7841552261166124`*^9}, {3.7841552846850915`*^9, 
   3.7841552924813147`*^9}, 3.7841553329379873`*^9, {3.7841553637877684`*^9, 
   3.784155464668498*^9}, 3.784155633529126*^9, 3.7841556794147577`*^9, 
   3.7841563600286446`*^9, {3.784156423447282*^9, 3.784156472504996*^9}, 
   3.784202692847534*^9, 3.7842027915873036`*^9, 3.784227265098278*^9, 
   3.784227306984744*^9, 3.7842365415305424`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q1", "=", "0"}], ",", 
      RowBox[{"q2", "=", "0"}], ",", 
      RowBox[{"q3", "=", "0"}], ",", 
      RowBox[{"q4", "=", "0"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Green", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q2", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Green", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q4", "]"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", 
                RowBox[{"Rectangle", "[", "]"}]}], "}"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
            RowBox[{"Slider", "[", 
             RowBox[{"Dynamic", "[", "q3", "]"}], "]"}]}], "}"}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "[", "plot1", "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784155765004445*^9, 3.7841558853984985`*^9}, {
  3.784155963593718*^9, 3.784155977408965*^9}, {3.7842357743651724`*^9, 
  3.7842357877347546`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cross", "[", 
  RowBox[{
   RowBox[{"R00", ".", "d1"}], ",", "l04"}], "]"}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "Cross","nonn1",
   "\"\:53d8\:91cf\:5fc5\:987b\:662f\:5177\:6709\:76f8\:7b49\:957f\:5ea6\:7684\
\:5411\:91cf\:ff0c\:53d8\:91cf\:6570\:76ee\:5fc5\:987b\:6bd4\:5b83\:4eec\:7684\
\:957f\:5ea6\:5c11 1.\"",2,155,31,25330088158049611827,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7842367117319775`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1`", " ", 
      RowBox[{"Sin", "[", "q1", "]"}], " ", 
      RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
    RowBox[{"0.`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.1`", " ", 
      RowBox[{"Cos", "[", "q1", "]"}], " ", 
      RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
    RowBox[{"0.06`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1`", " ", 
      RowBox[{"Cos", "[", "q2", "]"}]}]}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.7842367117359943`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R00", ".", "d1"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.784236718823616*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["l04"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"Sin", "[", "q1", "]"}], " ", 
     RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.1`", " ", 
     RowBox[{"Cos", "[", "q1", "]"}], " ", 
     RowBox[{"Sin", "[", "q2", "]"}]}]}], ",", 
   RowBox[{"0.06`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.1`", " ", 
     RowBox[{"Cos", "[", "q2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7842367226361403`*^9}]
}, Open  ]]
},
WindowSize->{750, 645},
WindowMargins->{{Automatic, -3}, {-70, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (2016\:5e7410\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 741, 19, 68, "Input"],
Cell[1302, 41, 1069, 34, 145, "Input"],
Cell[2374, 77, 852, 27, 126, "Input"],
Cell[3229, 106, 1826, 54, 126, "Input"],
Cell[5058, 162, 1102, 29, 164, "Input"],
Cell[6163, 193, 1164, 42, 126, "Input"],
Cell[7330, 237, 2336, 54, 142, "Input"],
Cell[9669, 293, 1513, 36, 105, "Input"],
Cell[CellGroupData[{
Cell[11207, 333, 893, 23, 84, "Input"],
Cell[12103, 358, 1223, 29, 184, "Output"]
}, Open  ]],
Cell[13341, 390, 122, 2, 30, "Input"],
Cell[13466, 394, 258, 6, 30, "Input"],
Cell[13727, 402, 1888, 47, 142, "Input"],
Cell[15618, 451, 1077, 32, 50, "Input"],
Cell[16698, 485, 1298, 28, 105, "Input"],
Cell[CellGroupData[{
Cell[18021, 517, 425, 10, 30, "Input"],
Cell[18449, 529, 1579, 30, 389, "Output"]
}, Open  ]],
Cell[20043, 562, 2458, 63, 253, "Input"],
Cell[CellGroupData[{
Cell[22526, 629, 110, 3, 47, "Input"],
Cell[22639, 634, 357, 7, 24, "Message"],
Cell[22999, 643, 650, 17, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23686, 665, 52, 1, 30, "Input"],
Cell[23741, 668, 135, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23913, 676, 29, 0, 30, "Input"],
Cell[23945, 678, 541, 14, 30, "Output"]
}, Open  ]]
}
]
*)

